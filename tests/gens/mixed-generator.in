#!/bin/bash

cat <<EOF

SRC=@SRCDIR@/src
BUILD=@BUILDDIR@/src
INSTR_CXXFLAGS=-DNANOS_INSTRUMENTATION_ENABLED

PLUGINS_performance=@PLUGINS_PERFORMANCE@
PLUGINS_debug=@PLUGINS_DEBUG@
PLUGINS_instrumentation=@PLUGINS_INSTRUMENTATION@

common_includes="-I\$SRC/core -I\$SRC/apis/c"

common_includes+=" 
        -I\$SRC/arch/unix-os \
        -I\$SRC/support \
        -I\$SRC/core \
        -I\$SRC/arch/smp \
        -I\$SRC/arch/spu"

common_cflags="-Wall -Werror"

compile_versions="@COMPILE_VERSIONS@"

test_CFLAGS="\$common_includes \$common_cflags"
test_CFLAGS_instrumentation="\$INSTR_CXXFLAGS"
test_CXXFLAGS="\$common_includes \$common_cflags"
test_CXXFLAGS_instrumentation="\$INSTR_CXXFLAGS"

test_LDFLAGS_performance="\$BUILD/core/performance/.libs/libnanox.so \$BUILD/apis/c/performance/.libs/libnanox-c.so"
test_ENV_performance="LD_LIBRARY_PATH=\$BUILD/core/performance/.libs:\$BUILD/apis/c/performance/.libs/:\$PLUGINS_performance:$LD_LIBRARY_PATH"

test_LDFLAGS_debug="\$BUILD/core/debug/.libs/libnanox.so \$BUILD/apis/c/debug/.libs/libnanox-c.so"
test_ENV_debug="LD_LIBRARY_PATH=\$BUILD/core/debug/.libs:\$BUILD/apis/c/debug/.libs/:\$PLUGINS_debug:$LD_LIBRARY_PATH"

test_LDFLAGS_instrumentation="\$BUILD/core/instrumentation/.libs/libnanox.so \$BUILD/apis/c/instrumentation/.libs/libnanox-c.so"
test_ENV_instrumentation="LD_LIBRARY_PATH=\$BUILD/core/instrumentation/.libs:\$BUILD/apis/c/instrumentation/.libs/:\$PLUGINS_instrumentation:$LD_LIBRARY_PATH"

`@SRCDIR@/tests/gens/config.py $*`
EOF

